<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>สมัครสมาชิก</title>
    <meta name="description" content="" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="../css/register.css" />
    <style>
      .password-toggle-icon {
        cursor: pointer;
        color: black;
      }
      .password-toggle-icon.hidden {
        color: gray;
      }
    </style>
  </head>

  <body>
    <div class="warpper">
      <form id="registerForm" action="/user/register" method="POST">
        <h1 class="title">สมัครสมาชิก</h1>    
        <% if (errors && errors.length > 0) { %>
          <% errors.forEach(function(error) { %>
            <p class="alert"><%= error %></p>
          <% }); %>
        <% } %>

        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />

        <div class="input-box">
          <span class="span-text">ชื่อผู้ใช้:</span>
          <input
            type="text"
            id="username"
            name="username"
            placeholder="ชื่อผู้ใช้"
            value="<%= username %>"
            required
          />
          <i class="fa fa-user"></i>
        </div>

        <!-- Password field -->
        <div class="input-box">
          <span class="span-text">รหัสผ่าน:</span>
          <input
            type="password"
            name="password"
            id="password"
            placeholder="รหัสผ่าน"
            value="<%= password %>"
            minlength="8"
            required
          />
          <i
            class="password-toggle-icon fas fa-eye"
            onclick="togglePasswordVisibility('password', this)"
            aria-label="Toggle password visibility"
          ></i>
        </div>
        <div class="despass">*รหัสผ่านต้องมีอักขระ 8 ตัวขึ้นไป</div>
        <div class="input-box">
          <span class="span-text">ยืนยันรหัสผ่าน:</span>
          <input
            type="password"
            name="confirmPassword"
            id="confirmPassword"
            placeholder="ยืนยันรหัสผ่าน"
            minlength="8"
            required
          />
          <i
            class="password-toggle-icon fas fa-eye"
            onclick="togglePasswordVisibility('confirmPassword', this)"
            aria-label="Toggle password visibility"
          ></i>
          <div id="confirmPasswordError" class="error" style="display: none;">รหัสผ่านไม่ตรงกัน</div>
        </div>
        <div class="input-box">
          <span class="span-text">อีเมล:</span>
          <input
            type="email"
            id="email"
            name="googleEmail"
            placeholder="อีเมล"
            value="<%= googleEmail %>"
            required
          />
          <i class="fa fa-envelope"></i>
        </div>

        <button type="submit" class="btn">สมัครสมาชิก</button>

        <!-- Register link -->
        <div class="register">
          <p>
            คุณมีบัญชีแล้วใช่หรือไม่
            <a href="/login">เข้าสู่ระบบเลย!</a>
          </p>
        </div>
      </form>
    </div>
    <script>
      function togglePasswordVisibility(fieldId, icon) {
        const passwordField = document.getElementById(fieldId);
        const isPasswordVisible = passwordField.type === "text";
        
        // Toggle password visibility
        passwordField.type = isPasswordVisible ? "password" : "text";
        
        // Toggle icon classes
        icon.classList.toggle("fa-eye", !isPasswordVisible);
        icon.classList.toggle("fa-eye-slash", isPasswordVisible);
      }
    
      document.getElementById("registerForm").addEventListener("submit", function(event) {
        const password = document.getElementById("password").value;
        const confirmPassword = document.getElementById("confirmPassword").value;
        const confirmPasswordError = document.getElementById("confirmPasswordError");
    
        if (password !== confirmPassword) {
          event.preventDefault();
          confirmPasswordError.style.display = "block";
        } else {
          confirmPasswordError.style.display = "none";
        }
      });
    </script>
    
  </body>
</html>
